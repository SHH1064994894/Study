package com.byteflyer.serialport;

import java.io.ByteArrayOutputStream;

public class MyFunc {
	private static String hexString = "0123456789ABCDEFabcdef";
	// -------------------------------------------------------
	static public int isOdd(int num) {
		return num & 0x1;
	}

	// -------------------------------------------------------
	static public int HexToInt(String inHex)// Hexï¿½Ö·ï¿½×ªint
	{
		return Integer.parseInt(inHex, 16);
	}

	// -------------------------------------------------------
	static public byte HexToByte(String inHex)// Hexï¿½Ö·ï¿½×ªbyte
	{
		return (byte) Integer.parseInt(inHex, 16);
	}

	// -------------------------------------------------------
	static public String Byte2Hex(Byte inByte)// 1ï¿½Ö½ï¿½×ª2ï¿½ï¿½Hexï¿½Ö·ï¿½
	{
		return String.format("%02x", inByte).toUpperCase();
	}

	// -------------------------------------------------------
	static public String ByteArrToHex(byte[] inBytArr)// ï¿½Ö½ï¿½ï¿½ï¿½ï¿½ï¿½×ª×ªhexï¿½Ö·ï¿½
	{
		StringBuilder strBuilder = new StringBuilder();
		int j = inBytArr.length;
		for (int i = 0; i < j; i++) {
			strBuilder.append(Byte2Hex(inBytArr[i]));
			strBuilder.append(" ");
		}
		return strBuilder.toString();
	}

	// -------------------------------------------------------
	static public String ByteArrToHex(byte[] inBytArr, int offset, int byteCount)// ï¿½Ö½ï¿½ï¿½ï¿½ï¿½ï¿½×ª×ªhexï¿½Ö·ï¿½ï¿½ï¿½Ñ¡ï¿½ï¿½ï¿½ï¿½
	{
		StringBuilder strBuilder = new StringBuilder();
		int j = byteCount;
		for (int i = offset; i < j; i++) {
			strBuilder.append(Byte2Hex(inBytArr[i]));
		}
		return strBuilder.toString();
	}

	// -------------------------------------------------------
	// ×ªhexï¿½Ö·ï¿½×ªï¿½Ö½ï¿½ï¿½ï¿½ï¿½ï¿½
	static public byte[] HexToByteArr(String inHex)// hexï¿½Ö·ï¿½×ªï¿½Ö½ï¿½ï¿½ï¿½ï¿½ï¿½
	{
		int hexlen = inHex.length();
		byte[] result;
		if (isOdd(hexlen) == 1) {// ï¿½ï¿½ï¿½ï¿½
			hexlen++;
			result = new byte[(hexlen / 2)];
			inHex = "0" + inHex;
		} else {// Å¼ï¿½ï¿½
			result = new byte[(hexlen / 2)];
		}
		int j = 0;
		for (int i = 0; i < hexlen; i += 2) {
			result[j] = HexToByte(inHex.substring(i, i + 2));
			j++;
		}
		return result;
	}

	public static String encode(String str) {
		byte[] bytes = str.getBytes();
		StringBuilder sb = new StringBuilder(bytes.length * 2);
		// è½¬æ¢hexç¼–ç 
		for (byte b : bytes) {
			sb.append(Integer.toHexString(b + 0x800).substring(1));
		}
		str = sb.toString();
		return str;
	}

	// æŠŠhexç¼–ç è½¬æ¢ä¸ºstring
	public static String decode(String bytes) {
		bytes = bytes.toUpperCase();
		ByteArrayOutputStream baos = new ByteArrayOutputStream(
				bytes.length() / 2);
		// å°†æ¯2ä½?16è¿›åˆ¶æ•´æ•°ç»„è£…æˆä¸€ä¸ªå­—èŠ?
		for (int i = 0; i < bytes.length(); i += 2)
			baos.write((hexString.indexOf(bytes.charAt(i)) << 4 | hexString
					.indexOf(bytes.charAt(i + 1))));
		return new String(baos.toByteArray());
	}
}